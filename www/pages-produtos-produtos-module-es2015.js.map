{"version":3,"sources":["./src/pages/produtos/produtos.page.html","./src/pages/produtos/produtos-routing.module.ts","./src/pages/produtos/produtos.module.ts","./src/pages/produtos/produtos.page.scss","./src/pages/produtos/produtos.page.ts"],"names":[],"mappings":"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","file":"pages-produtos-produtos-module-es2015.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title>Produtos</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content padding *ngIf=\\\"items$ | async as items\\\">\\n  <ion-refresher slot=\\\"fixed\\\" (ionRefresh)=\\\"doRefresh($event)\\\">\\n    <ion-refresher-content></ion-refresher-content>\\n  </ion-refresher>\\n\\n  <ion-fab vertical=\\\"top\\\" horizontal=\\\"end\\\" edge slot=\\\"fixed\\\">\\n    <ion-fab-button routerLink=\\\"/cart\\\">\\n      <ion-icon name=\\\"cart\\\"></ion-icon>\\n    </ion-fab-button>\\n  </ion-fab>\\n\\n  <ion-list>\\n    <ion-item button *ngFor=\\\"let item of items\\\" routerLink=\\\"/produto-detail/{{item.id}}\\\">\\n      <ion-thumbnail slot=\\\"start\\\">\\n        <img [src]=\\\"item.imageUrl || 'assets/imgs/prod.jpg'\\\">\\n      </ion-thumbnail>\\n      <ion-label>\\n        <h2>{{item.nome}}</h2>\\n        <p>{{item.preco | currency}}</p>\\n      </ion-label>\\n    </ion-item>\\n  </ion-list>\\n\\n  <ion-infinite-scroll threshold=\\\"100px\\\" (ionInfinite)=\\\"doInfinite($event, items)\\\">\\n    <ion-infinite-scroll-content loadingSpinner=\\\"bubbles\\\" loadingText=\\\"Aguarde...\\\">\\n    </ion-infinite-scroll-content>\\n  </ion-infinite-scroll>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { ProdutosPage } from './produtos.page';\n\n\nconst routes: Routes = [\n  { path: ':categoriaId', component: ProdutosPage }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ProdutosPageRoutingModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ProdutosPageRoutingModule } from './produtos-routing.module';\n\nimport { ProdutosPage } from './produtos.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ProdutosPageRoutingModule\n  ],\n  declarations: [ProdutosPage]\n})\nexport class ProdutosPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvcGFnZXMvcHJvZHV0b3MvcHJvZHV0b3MucGFnZS5zY3NzIn0= */\";","import { Component } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { from, Observable } from 'rxjs';\nimport { map, mergeMap, reduce, switchMap, tap } from 'rxjs/operators';\nimport { environment } from 'src/environments/environment';\nimport { ProdutoService } from 'src/services/domain/produto.service';\nimport { ProdutoDTO } from './../../models/produto.dto';\n\n@Component({\n  selector: 'app-produtos',\n  templateUrl: './produtos.page.html',\n  styleUrls: ['./produtos.page.scss'],\n})\nexport class ProdutosPage {\n  page = 0;\n  items$: Observable<ProdutoDTO[]>;\n\n  constructor(\n    private activatedRoute: ActivatedRoute,\n    private service: ProdutoService,\n  ) {\n    this.items$ = this.loadData();\n  }\n\n  loadData(produtoDtos?: ProdutoDTO[]) {\n    const categoriaId = this.activatedRoute.snapshot.params.categoriaId;\n    return this.service.findByCategoria({ categorias: `${categoriaId}`, page: `${this.page}`, linesPerPage: `${10}` }).pipe(\n      map(p => {\n        if (produtoDtos) return [...p, ...produtoDtos]\n        return p;\n      }),\n      switchMap(p => this.loadImageUrls(p)),\n    );\n  }\n\n  loadImageUrls(items: ProdutoDTO[]) {\n    return from(items).pipe(\n      mergeMap(item => {\n        return this.service.getSmallImageFromBucket(item.id).pipe(\n          map<Blob, ProdutoDTO>(() => ({ ...item, imageUrl: `${environment.BUCKET_URL}/prod${item.id}-small.jpg` })),\n        );\n      }),\n      reduce<ProdutoDTO, ProdutoDTO[]>((lista, produto) => [...lista, produto], []),\n    );\n  }\n\n  doRefresh(event) {\n    this.items$ = this.loadData().pipe(\n      tap(() => this.page = 0),\n      tap(() => setTimeout(() => event.target.complete(), 500))\n    );\n  }\n\n  doInfinite(event, items: ProdutoDTO[]) {\n    this.items$ = this.loadData(items).pipe(\n      tap(() => this.page++),\n      tap(() => setTimeout(() => event.target.complete(), 500))\n    );\n  }\n}\n"],"sourceRoot":"webpack:///"}